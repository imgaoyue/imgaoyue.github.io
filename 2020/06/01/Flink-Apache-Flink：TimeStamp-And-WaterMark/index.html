<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="baidu-site-verification" content="uHZGT15IXQ" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="GaoThinkÂ·æ€è€ƒå¿—">
    <meta name="keyword"  content="å¤§æ•°æ®,Bigdata,Linux,CDH">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!--<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>-->
   
	<title>
        
          Apache Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å° - GaoThinkÂ·æ€è€ƒå¿—
        
    </title>

    <link rel="canonical" href="http://gaothink.top/2020/06/01/Flink-Apache-Flinkï¼šTimeStamp-And-WaterMark/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
        
<link rel="stylesheet" href="/css/dusign-light.css">

        
<link rel="stylesheet" href="/css/dusign-common-light.css">

        
<link rel="stylesheet" href="/css/font-awesome.css">

        
<link rel="stylesheet" href="/css/toc.css">

        <!-- background effects end -->
    
    
	<!-- fancybox support -->
    
      
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

    
	
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/fonts.googleapis.css">


    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- photography -->
    
<link rel="stylesheet" href="/css/photography.css">


    <!-- ga & ba script hoook -->
    <script></script>
	
	
	<!-- Baidu Tongji -->
    
    <script>
        // dynamic User by Hux
        var _baId = '3c93829ba3b988ba61d1e9a4688967d3';
    
        // Originial
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?" + _baId;
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
    </script>

	
<meta name="generator" content="Hexo 4.2.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- background effects start -->
    
    <!-- background effects end -->

	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            
                background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('')
                /*post*/
            
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Flink" title="Flink">Flink</a>
                            
                        </div>
                        <h1>Apache Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by GY on
                            2020-06-01
                        </span>

                        
                            <div class="blank_box"></div>
                            <span class="meta">
                                Words <span class="post-count">2.8k</span> and
                                Reading Time <span class="post-count">10</span> Minutes
                            </span>
                            <div class="blank_box"></div>
                            <!-- ä¸è’œå­ç»Ÿè®¡ start -->
                            <span class="meta">
                                Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
                            </span>
                            <!-- ä¸è’œå­ç»Ÿè®¡ end -->
                        

                    </div>
                

                </div>
            </div>
        </div>      
    </div>

    
    <div class="waveWrapper">
        <div class="wave wave_before" style="background-image: url('/img/wave-light.png')"></div>
        <div class="wave wave_after" style="background-image: url('/img/wave-light.png')"></div>
    </div>
    
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">GaoThink</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/categories/">Categories</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1 id="Apache-Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°"><a href="#Apache-Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°" class="headerlink" title="Apache Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°"></a>Apache Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°</h1><p>FlinkåŸºäºEventTimeå’ŒWaterMarkå¤„ç†ä¹±åºäº‹ä»¶å’Œæ™šåˆ°çš„æ•°æ®ï¼Œæ˜¯å¸¸è§çš„ä»»åŠ¡åœºæ™¯</p>
<p>å¯¹äºTimeStamp å’Œ WaterMark è¿™ä¸¤ä¸ªFlinkå…³é”®è¯ï¼Œå¾ˆé•¿æ—¶é—´éƒ½æ˜¯ç¨€é‡Œç³Šæ¶‚ï¼Œå‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Œåªèƒ½æŒ‰ç…§æ¨¡æ¿å»å†™ï¼Œä¸æ˜å…¶ä¸­æ‰€ä»¥ï¼ŒSo Â·Â·Â·Â·  åœ¨æ­¤æˆ‘ä»¬é‡æ–°æ•´ç†ä¸€ä¸‹ç›¸å…³å†…å®¹</p>
<h2 id="Flink-æ—¶é—´è¯­ä¹‰"><a href="#Flink-æ—¶é—´è¯­ä¹‰" class="headerlink" title="Flink æ—¶é—´è¯­ä¹‰"></a>Flink æ—¶é—´è¯­ä¹‰</h2><p>åœ¨ Flink ä¸­ Time å¯ä»¥åˆ†ä¸ºä¸‰ç§Event-Timeï¼ŒProcessing-Time ä»¥åŠ Ingestion-Timeï¼Œä¸‰è€…çš„å…³ç³»æˆ‘ä»¬å¯ä»¥ä»ä¸‹å›¾ä¸­å¾—çŸ¥ï¼š</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601145432.png" style="width:600px"/></p>
<p>å…¶æ ¸å¿ƒæ˜¯ <strong>Processing Time</strong> å’Œ <strong>Event Timeï¼ˆRow Timeï¼‰</strong></p>
<p>Processing Time æ˜¯æ¥æ¨¡æ‹Ÿæˆ‘ä»¬çœŸå®ä¸–ç•Œçš„æ—¶é—´ï¼Œå…¶å®å°±ç®—æ˜¯å¤„ç†æ•°æ®çš„èŠ‚ç‚¹æœ¬åœ°æ—¶é—´ä¹Ÿä¸ä¸€å®šå°±æ˜¯å®Œå®Œå…¨å…¨çš„æˆ‘ä»¬çœŸå®ä¸–ç•Œçš„æ—¶é—´ï¼Œæ‰€ä»¥è¯´å®ƒæ˜¯ç”¨æ¥æ¨¡æ‹ŸçœŸå®ä¸–ç•Œçš„æ—¶é—´ã€‚è€Œ Event Time æ˜¯æ•°æ®ä¸–ç•Œçš„æ—¶é—´ï¼Œå°±æ˜¯æˆ‘ä»¬è¦å¤„ç†çš„æ•°æ®æµä¸–ç•Œé‡Œé¢çš„æ—¶é—´ã€‚å…³äºä»–ä»¬çš„è·å–æ–¹å¼ï¼ŒProcess Time æ˜¯é€šè¿‡ç›´æ¥å»è°ƒç”¨æœ¬åœ°æœºå™¨çš„æ—¶é—´ï¼Œè€Œ Event Timeåˆ™æ˜¯æ ¹æ®æ¯ä¸€æ¡å¤„ç†è®°å½•æ‰€æºå¸¦çš„æ—¶é—´æˆ³æ¥åˆ¤å®šã€‚</p>
<p>ç›¸å¯¹è€Œè¨€çš„ ProcessingTime å¤„ç†èµ·æ¥æ›´åŠ çš„ç®€å•ï¼Œè€Œ Event Time è¦æ›´éº»çƒ¦ä¸€äº›ã€‚è€Œåœ¨ä½¿ç”¨Processing Time çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å¤„ç†ç»“æœï¼ˆæˆ–è€…è¯´æµå¤„ç†åº”ç”¨çš„å†…éƒ¨çŠ¶æ€ï¼‰æ˜¯ä¸ç¡®å®šçš„ã€‚è€Œå› ä¸ºåœ¨ Flink å†…éƒ¨å¯¹ Event Time åšäº†å„ç§ä¿éšœï¼Œ<strong>ä½¿ç”¨ EventTime çš„æƒ…å†µä¸‹ï¼Œæ— è®ºé‡æ”¾æ•°æ®å¤šå°‘æ¬¡ï¼Œéƒ½èƒ½å¾—åˆ°ä¸€ä¸ªç›¸å¯¹ç¡®å®šå¯é‡ç°çš„ç»“æœ</strong>ã€‚</p>
<p>å› æ­¤åœ¨åˆ¤æ–­åº”è¯¥ä½¿ç”¨ Processing Time è¿˜æ˜¯ Event Time çš„æ—¶å€™ï¼Œå¯ä»¥éµå¾ªä¸€ä¸ªåŸåˆ™ï¼š<strong>å½“ä½ çš„åº”ç”¨é‡åˆ°æŸäº›é—®é¢˜è¦ä»ä¸Šä¸€ä¸ª checkpoint æˆ–è€… savepoint è¿›è¡Œé‡æ”¾ï¼Œæ˜¯ä¸æ˜¯å¸Œæœ›ç»“æœå®Œå…¨ç›¸åŒ</strong>ã€‚å¦‚æœå¸Œæœ›ç»“æœå®Œå…¨ç›¸åŒï¼Œå°±åªèƒ½ç”¨Event Timeï¼›å¦‚æœæ¥å—ç»“æœä¸åŒï¼Œåˆ™å¯ä»¥ç”¨ Processing Timeã€‚</p>
<p>Processing Time çš„ä¸€ä¸ªå¸¸è§çš„ç”¨é€”æ˜¯ï¼Œæˆ‘ä»¬è¦æ ¹æ®ç°å®æ—¶é—´æ¥ç»Ÿè®¡æ•´ä¸ªç³»ç»Ÿçš„ååï¼Œæ¯”å¦‚è¦è®¡ç®—ç°å®æ—¶é—´ä¸€ä¸ªå°æ—¶å¤„ç†äº†å¤šå°‘æ¡æ•°æ®ï¼Œè¿™ç§æƒ…å†µåªèƒ½ä½¿ç”¨Processing Timeã€‚</p>
<hr>
<h2 id="Windowåˆ’åˆ†"><a href="#Windowåˆ’åˆ†" class="headerlink" title="Windowåˆ’åˆ†"></a>Windowåˆ’åˆ†</h2><p>windowçš„è®¾å®šæ— å…³æ•°æ®æœ¬èº«ï¼Œè€Œæ˜¯ç³»ç»Ÿå®šä¹‰å¥½äº†çš„ã€‚</p>
<p>windowæ˜¯Flinkä¸­åˆ’åˆ†æ•°æ®ä¸€ä¸ªåŸºæœ¬å•ä½ï¼Œwindowçš„åˆ’åˆ†æ–¹å¼æ˜¯å›ºå®šçš„ï¼Œ<strong>é»˜è®¤ä¼šæ ¹æ®è‡ªç„¶æ—¶é—´åˆ’åˆ†window</strong>ï¼Œå¹¶ä¸”åˆ’åˆ†æ–¹å¼æ˜¯å‰é—­åå¼€ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>windowåˆ’åˆ†</th>
<th>w1</th>
<th>w2</th>
<th>w3</th>
</tr>
</thead>
<tbody>
<tr>
<td>3s</td>
<td>[00:00:00~00:00:03)</td>
<td>[00:00:03~00:00:06)</td>
<td>[00:00:06~00:00:09)</td>
</tr>
<tr>
<td>5s</td>
<td>[00:00:00~00:00:05)</td>
<td>[00:00:05~00:00:10)</td>
<td>[00:00:10~00:00:15)</td>
</tr>
<tr>
<td>10s</td>
<td>[00:00:00~00:00:10)</td>
<td>[00:00:10~00:00:20)</td>
<td>[00:00:20~00:00:30)</td>
</tr>
<tr>
<td>1min</td>
<td>[00:00:00~00:01:00)</td>
<td>[00:01:00~00:02:00)</td>
<td>[00:02:00~00:03:00)</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2 id="Watermarkæ°´å°"><a href="#Watermarkæ°´å°" class="headerlink" title="Watermarkæ°´å°"></a>Watermarkæ°´å°</h2><p>é‚£æˆ‘ä»¬æ€ä¹ˆä¿è¯åŸºäº event-time çš„çª—å£åœ¨é”€æ¯çš„æ—¶å€™ï¼Œå·²ç»å¤„ç†å®Œäº†æ‰€æœ‰çš„æ•°æ®å‘¢ï¼Ÿè¿™å°±æ˜¯ watermark çš„åŠŸèƒ½æ‰€åœ¨ã€‚watermark ä¼šæºå¸¦ä¸€ä¸ªå•è°ƒé€’å¢çš„æ—¶é—´æˆ³ tï¼Œwatermark(t) è¡¨ç¤ºæ‰€æœ‰æ—¶é—´æˆ³ä¸å¤§äº t çš„æ•°æ®éƒ½å·²ç»åˆ°æ¥äº†ï¼Œæœªæ¥å°äºç­‰äºtçš„æ•°æ®ä¸ä¼šå†æ¥ï¼Œå› æ­¤å¯ä»¥æ”¾å¿ƒåœ°è§¦å‘å’Œé”€æ¯çª—å£äº†ã€‚ä¸‹å›¾ä¸­ç»™äº†ä¸€ä¸ªä¹±åºæ•°æ®æµä¸­çš„ watermark ä¾‹å­</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601203828.png"/></p>
<hr>
<h2 id="æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°"><a href="#æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°" class="headerlink" title="æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°"></a>æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œæµå¤„ç†ä»äº‹ä»¶äº§ç”Ÿï¼Œåˆ°æµç»sourceï¼Œå†åˆ°operatorï¼Œä¸­é—´æ˜¯æœ‰ä¸€ä¸ªè¿‡ç¨‹å’Œæ—¶é—´çš„ã€‚è™½ç„¶å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæµåˆ°operatorçš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§äº‹ä»¶äº§ç”Ÿçš„æ—¶é—´é¡ºåºæ¥çš„ï¼Œä½†æ˜¯ä¹Ÿä¸æ’é™¤ç”±äºç½‘ç»œã€èƒŒå‹ç­‰åŸå› ï¼Œå¯¼è‡´ä¹±åºçš„äº§ç”Ÿã€‚ä½†æ˜¯å¯¹äºè¶…æ—¶æ•°æ®ï¼Œæˆ‘ä»¬åˆä¸èƒ½æ— é™æœŸçš„ç­‰ä¸‹å»ï¼Œå¿…é¡»è¦æœ‰ä¸ªæœºåˆ¶æ¥ä¿è¯ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´åï¼Œå¿…é¡»è§¦å‘windowå»è¿›è¡Œè®¡ç®—äº†ã€‚è€Œè¿™ä¸ªç‰¹åˆ«çš„æœºåˆ¶ï¼Œå°±æ˜¯watermarkã€‚</p>
<p>Flinkæä¾›äº†ç»Ÿä¸€çš„<code>DataStream.assignTimestampsAndWatermarks()</code>æ–¹æ³•æ¥æå–äº‹ä»¶æ—¶é—´å¹¶åŒæ—¶äº§ç”Ÿæ°´å°ï¼Œæ¯•ç«Ÿå®ƒä»¬åœ¨å¤„ç†è¿‡ç¨‹ä¸­æ˜¯ç´§å¯†è”ç³»çš„ã€‚</p>
<p><code>assignTimestampsAndWatermarks()</code>æ–¹æ³•æ¥å—çš„å‚æ•°ç±»å‹æœ‰<code>AssignerWithPeriodicWatermarks</code>å’Œ<code>AssignerWithPunctuatedWatermarks</code>ä¸¤ç§ï¼Œåˆ†åˆ«å¯¹åº”å‘¨æœŸæ€§æ°´å°å’Œæ‰“ç‚¹ï¼ˆå³ç”±äº‹ä»¶æœ¬èº«çš„å±æ€§è§¦å‘ï¼‰æ°´å°ï¼Œå®ƒä»¬çš„ç±»å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601175911.png" style="width:800px"/></p>
<p><strong>Watermarkæ˜¯ç”¨äºå¤„ç†ä¹±åºäº‹ä»¶çš„ï¼Œè€Œæ­£ç¡®çš„å¤„ç†ä¹±åºäº‹ä»¶ï¼Œé€šå¸¸ç”¨watermarkæœºåˆ¶ç»“åˆwindowæ¥å®ç°</strong></p>
<h3 id="å‘¨æœŸæ€§æ°´å°-WithPeriodicWatermarks"><a href="#å‘¨æœŸæ€§æ°´å°-WithPeriodicWatermarks" class="headerlink" title="å‘¨æœŸæ€§æ°´å°(WithPeriodicWatermarks)"></a>å‘¨æœŸæ€§æ°´å°(WithPeriodicWatermarks)</h3><p>é¡¾åæ€ä¹‰ï¼Œä½¿ç”¨<code>AssignerWithPeriodicWatermarks</code>æ—¶ï¼Œæ°´å°æ˜¯å‘¨æœŸæ€§äº§ç”Ÿçš„ã€‚è¯¥å‘¨æœŸé»˜è®¤ä¸º200msï¼Œä¹Ÿèƒ½é€šè¿‡<code>ExecutionConfig.setAutoWatermarkInterval()</code>æ–¹æ³•æ¥æŒ‡å®šæ–°çš„å‘¨æœŸã€‚</p>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡å®ç°<code>extractTimestamp()</code>æ–¹æ³•æ¥æå–äº‹ä»¶æ—¶é—´ï¼Œå®ç°<code>getCurrentWatermark()</code>æ–¹æ³•äº§ç”Ÿæ°´å°ã€‚ä½†å¥½åœ¨Flinkå·²ç»æä¾›äº†3ç§å†…ç½®çš„å®ç°ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨å°±å¯ä»¥äº†ï¼Œçœäº‹ã€‚</p>
<h4 id="AscendingTimestampExtractor"><a href="#AscendingTimestampExtractor" class="headerlink" title="AscendingTimestampExtractor"></a>AscendingTimestampExtractor</h4><p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601192227.png"/></p>
<p><code>AscendingTimestampExtractor</code>äº§ç”Ÿçš„æ—¶é—´æˆ³å’Œæ°´å°å¿…é¡»æ˜¯å•è°ƒéé€’å‡çš„ï¼Œç”¨æˆ·é€šè¿‡è¦†å†™<code>extractAscendingTimestamp()</code>æ–¹æ³•æŠ½å–æ—¶é—´æˆ³ã€‚å¦‚æœäº§ç”Ÿäº†é€’å‡çš„æ—¶é—´æˆ³ï¼Œå°±è¦ä½¿ç”¨åä¸ºMonotonyViolationHandlerçš„ç»„ä»¶å¤„ç†å¼‚å¸¸ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼šæ‰“å°è­¦å‘Šæ—¥å¿—ï¼ˆé»˜è®¤ï¼‰å’ŒæŠ›å‡ºRuntimeExceptionã€‚</p>
<p>å•è°ƒé€’å¢çš„äº‹ä»¶æ—¶é—´å¹¶ä¸å¤ªç¬¦åˆå®é™…æƒ…å†µï¼Œæ‰€ä»¥<code>AscendingTimestampExtractor</code>ç”¨å¾—ä¸å¤šã€‚</p>
<h4 id="BoundedOutOfOrdernessTimestampExtractor"><a href="#BoundedOutOfOrdernessTimestampExtractor" class="headerlink" title="BoundedOutOfOrdernessTimestampExtractor"></a>BoundedOutOfOrdernessTimestampExtractor</h4><p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601192348.png" style="width:800px"/></p>
<p>å¯ä»¥è®¾ç½® <strong>å…è®¸å›ºå®šæœ€å¤§æ—¶é—´èŒƒå›´å†…çš„å»¶è¿Ÿ</strong>ï¼Œæ¯”å¦‚å›ºå®šæ—¶é—´é—´éš”ä¸­å‘¨æœŸæ€§å‘é€æ•°æ®çš„æ•°æ®æºï¼Œå› ä¸ºæ•°æ®å‘é€çš„é—´éš”æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®ä¸€ä¸ªå›ºå®šçš„æœ€å¤§å…è®¸å»¶è¿Ÿæ—¶é—´</p>
<p>å½“ç„¶ï¼Œå»¶è¿Ÿæ—¶é—´çš„é•¿åº¦è¦æ ¹æ®å®é™…ç¯å¢ƒè°¨æ…è®¾å®šï¼Œè®¾å®šå¾—å¤ªçŸ­ä¼šä¸¢è¾ƒå¤šçš„æ•°æ®ï¼Œè®¾å®šå¾—å¤ªé•¿ä¼šå¯¼è‡´çª—å£è§¦å‘å»¶è¿Ÿï¼Œå®æ—¶æ€§å‡å¼±ã€‚</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªBoundedOutOfOrdernessTimestampExtractor</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601171810.png" style="width:800px"/></p>
<h4 id="IngestionTimeExtractor"><a href="#IngestionTimeExtractor" class="headerlink" title="IngestionTimeExtractor"></a>IngestionTimeExtractor</h4><p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601192506.png" style="width:800px"/></p>
<p>IngestionTimeExtractoråŸºäºå½“å‰ç³»ç»Ÿæ—¶é’Ÿç”Ÿæˆæ—¶é—´æˆ³å’Œæ°´å°ï¼Œå…¶å®å°±æ˜¯Flinkä¸‰å¤§æ—¶é—´ç‰¹å¾é‡Œçš„æ‘„å…¥æ—¶é—´äº†ã€‚</p>
<h3 id="æ‰“ç‚¹æ°´å°-AssignerWithPunctuatedWatermarks"><a href="#æ‰“ç‚¹æ°´å°-AssignerWithPunctuatedWatermarks" class="headerlink" title="æ‰“ç‚¹æ°´å°(AssignerWithPunctuatedWatermarks)"></a>æ‰“ç‚¹æ°´å°(AssignerWithPunctuatedWatermarks)</h3><p>æ‰“ç‚¹æ°´å°æ¯”å‘¨æœŸæ€§æ°´å°ç”¨çš„è¦å°‘ä¸å°‘ï¼Œå¹¶ä¸”Flinkæ²¡æœ‰å†…ç½®çš„å®ç°ï¼Œé‚£ä¹ˆå°±å†™ä¸ªæœ€ç®€å•çš„æ —å­å§ï¼</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601193448.png" style="width:800px"/></p>
<p><code>AssignerWithPunctuatedWatermarks</code>é€‚ç”¨äºéœ€è¦ä¾èµ–äºäº‹ä»¶æœ¬èº«çš„æŸäº›å±æ€§å†³å®šæ˜¯å¦å‘å°„æ°´å°çš„æƒ…å†µã€‚æˆ‘ä»¬å®ç°<code>checkAndGetNextWatermark()</code>æ–¹æ³•æ¥äº§ç”Ÿæ°´å°ï¼Œäº§ç”Ÿçš„æ—¶æœºå®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶ã€‚ä¸Šé¢ä¾‹å­ä¸­æ˜¯æ”¶å–åˆ°ç”¨æˆ·IDæœ«ä½ä¸º0çš„æ•°æ®æ—¶æ‰å‘å°„ã€‚</p>
<blockquote>
<p>è¿˜æœ‰ä¸‰ç‚¹éœ€è¦æé†’ï¼š</p>
<ul>
<li>ä¸ç®¡ä½¿ç”¨å“ªç§æ–¹å¼äº§ç”Ÿæ°´å°ï¼Œéƒ½ä¸èƒ½è¿‡äºé¢‘ç¹ã€‚å› ä¸ºWatermarkå¯¹è±¡æ˜¯ä¼šå…¨éƒ¨æµå‘ä¸‹æ¸¸çš„ï¼Œä¹Ÿä¼šå®æ‰“å®åœ°å ç”¨å†…å­˜ï¼Œæ°´å°è¿‡å¤šä¼šé€ æˆç³»ç»Ÿæ€§èƒ½ä¸‹é™ã€‚</li>
<li>æ°´å°çš„ç”Ÿæˆè¦å°½é‡æ—©ï¼Œä¸€èˆ¬æ˜¯åœ¨æ¥å…¥Sourceä¹‹åå°±äº§ç”Ÿï¼Œæˆ–è€…åœ¨Sourceç»è¿‡ç®€å•çš„å˜æ¢ï¼ˆmapã€filterç­‰ï¼‰ä¹‹åäº§ç”Ÿã€‚</li>
<li>å¦‚æœéœ€æ±‚æ–¹å¯¹äº‹ä»¶æ—¶é—´carryçš„ä¸šåŠ¡æ„ä¹‰å¹¶ä¸å…³å¿ƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤„ç†æ—¶é—´ï¼Œç®€å•æ–¹ä¾¿ã€‚</li>
</ul>
</blockquote>
<hr>
<h2 id="AllowedLatenessä»‹ç»"><a href="#AllowedLatenessä»‹ç»" class="headerlink" title="AllowedLatenessä»‹ç»"></a>AllowedLatenessä»‹ç»</h2><p><strong>allowedLatenessåªé’ˆå¯¹eventTime</strong>ï¼Œå› ä¸ºprocessingTimeä¸å­˜åœ¨å»¶æ—¶çš„æƒ…å†µã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“watermarké€šè¿‡end-of-windowä¹‹åï¼Œå†æœ‰ä¹‹å‰çš„æ•°æ®åˆ°è¾¾æ—¶ï¼Œè¿™äº›æ•°æ®ä¼šè¢«åˆ é™¤ã€‚</p>
<p>ä¸ºäº†é¿å…æœ‰äº›è¿Ÿåˆ°çš„æ•°æ®è¢«åˆ é™¤ï¼Œå› æ­¤äº§ç”Ÿäº†allowedLatenessçš„æ¦‚å¿µï¼Œä½¿ç”¨allowedLatenesså»¶è¿Ÿé”€æ¯çª—å£ï¼Œå…è®¸æœ‰ä¸€æ®µæ—¶é—´ï¼ˆä¹Ÿæ˜¯ä»¥event timeæ¥è¡¡é‡ï¼‰æ¥ç­‰å¾…ä¹‹å‰çš„æ•°æ®åˆ°è¾¾ï¼Œä»¥ä¾¿å†æ¬¡å¤„ç†è¿™äº›æ•°æ®ã€‚ã€‚</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601195219.png" style="width:600px"/></p>
<p><strong>æ³¨æ„</strong>ï¼šå¯¹äºtriggeræ˜¯é»˜è®¤çš„EventTimeTriggerçš„æƒ…å†µä¸‹ï¼ŒallowedLatenessä¼šå†æ¬¡è§¦å‘çª—å£çš„è®¡ç®—ï¼Œè€Œä¹‹å‰è§¦å‘çš„æ•°æ®ï¼Œä¼šbufferèµ·æ¥ï¼Œç›´åˆ°watermarkè¶…è¿‡end-of-window + allowedLatenessçš„æ—¶é—´ï¼Œçª—å£çš„æ•°æ®åŠå…ƒæ•°æ®ä¿¡æ¯æ‰ä¼šè¢«åˆ é™¤ã€‚å†æ¬¡è®¡ç®—å°±æ˜¯DataFlowæ¨¡å‹ä¸­çš„Accumulatingçš„æƒ…å†µã€‚</p>
<p><strong>ç›¸å…³æºç </strong></p>
<p><code>org.apache.flink.streaming.api.datastream.WindowedStream</code></p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200601200612.png" style="width:800px"/></p>
<p>WindowedStreamæœ‰ä¸¤ä¸ªå‚æ•°è·ŸAllowed Latenessç›¸å…³</p>
<p>ä¸€ä¸ªæ˜¯<strong>allowedLateness</strong>ï¼Œç”¨äºæŒ‡å®šå…è®¸å…ƒç´ è¿Ÿåˆ°çš„æ—¶é—´é•¿åº¦</p>
<p>ä¸€ä¸ªæ˜¯<strong>lateDataOutputTag</strong>ï¼Œç”¨äºé…ç½®è¿Ÿåˆ°å…ƒç´ çš„è¾“å‡º</p>
<p>æ—¢ç„¶æœ‰äº†watermarkäº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æallowedLateness ??</p>
<p>å› ä¸ºwatermarkæ˜¯å…¨å±€çš„ï¼Œä¸æ­¢é’ˆå¯¹windowè®¡ç®—ï¼Œè€ŒallowedLatenessè®©windowå‡½æ•°èƒ½è‡ªå·±æ§åˆ¶å¤„ç†å»¶è¿Ÿæ•°æ®çš„ç­–ç•¥ã€‚</p>
<hr>
<h2 id="è¿Ÿåˆ°æ•°æ®å¤„ç†"><a href="#è¿Ÿåˆ°æ•°æ®å¤„ç†" class="headerlink" title="è¿Ÿåˆ°æ•°æ®å¤„ç†"></a>è¿Ÿåˆ°æ•°æ®å¤„ç†</h2><h4 id="å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ"><a href="#å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ" class="headerlink" title="å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ"></a>å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ</h4><p>å¦‚æœä¸åšå…¶ä»–æ“ä½œï¼Œé»˜è®¤æƒ…å†µä¸‹è¿Ÿåˆ°æ•°æ®ä¼šè¢«ç›´æ¥ä¸¢å¼ƒã€‚</p>
<h4 id="ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®"><a href="#ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®" class="headerlink" title="ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®"></a>ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®</h4><p>å¦‚æœæƒ³å¯¹è¿™äº›è¿Ÿåˆ°æ•°æ®å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Flinkçš„ä¾§è¾“å‡ºï¼ˆSide Outputï¼‰åŠŸèƒ½ï¼Œå°†è¿Ÿåˆ°æ•°æ®å‘åˆ°æŸä¸ªç‰¹å®šçš„æµä¸Šã€‚åç»­æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸šåŠ¡é€»è¾‘çš„è¦æ±‚ï¼Œå¯¹è¿Ÿåˆ°çš„æ•°æ®æµè¿›è¡Œå¤„ç†ã€‚</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200602134717.png" style="width:800px"/></p>
<p>ä¸Šé¢çš„ä»£ç å°†è¿Ÿåˆ°çš„å†…å®¹å†™è¿›åä¸ºâ€œlate-elementsâ€çš„<code>OutputTag</code>ä¸‹ï¼Œä¹‹åä½¿ç”¨<code>getSideOutput</code>è·å–è¿™äº›è¿Ÿåˆ°çš„æ•°æ®ã€‚</p>
<h4 id="æ›´æ–°è®¡ç®—ç»“æœ"><a href="#æ›´æ–°è®¡ç®—ç»“æœ" class="headerlink" title="æ›´æ–°è®¡ç®—ç»“æœ"></a>æ›´æ–°è®¡ç®—ç»“æœ</h4><p>å¯¹äºè¿Ÿåˆ°æ•°æ®ï¼Œä½¿ç”¨ä¸Šé¢ä¸¤ç§æ–¹æ³•ï¼Œéƒ½å¯¹è®¡ç®—ç»“æœçš„æ­£ç¡®æ€§æœ‰å½±å“ã€‚å¦‚æœå°†æ•°æ®æµå‘é€åˆ°å•ç‹¬çš„ä¾§è¾“å‡ºï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦å®Œæˆå•ç‹¬çš„å¤„ç†é€»è¾‘ï¼Œç›¸å¯¹æ¯”è¾ƒå¤æ‚ã€‚æ›´ç†æƒ³çš„æƒ…å†µæ˜¯ï¼Œå°†è¿Ÿåˆ°æ•°æ®é‡æ–°è¿›è¡Œä¸€æ¬¡ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´æ–°çš„ç»“æœã€‚ <code>allowedLateness</code><strong>å…è®¸ç”¨æˆ·åœ¨Event Timeä¸‹å¯¹æŸä¸ªçª—å£å…ˆå¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æœ‰è¿Ÿåˆ°æ•°æ®ï¼Œè¿Ÿåˆ°æ•°æ®ä¼šå’Œä¹‹å‰çš„æ•°æ®ä¸€èµ·é‡æ–°è¢«è®¡ç®—ï¼Œä»¥å¾—åˆ°ä¸€ä¸ªæ›´å‡†ç¡®çš„ç»“æœ</strong>ã€‚ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½æ—¶éœ€è¦æ³¨æ„ï¼ŒåŸæ¥çª—å£ä¸­çš„çŠ¶æ€æ•°æ®åœ¨çª—å£å·²ç»è§¦å‘çš„æƒ…å†µä¸‹ä»ç„¶ä¼šè¢«ä¿ç•™ï¼Œå¦åˆ™è¿Ÿåˆ°æ•°æ®åˆ°æ¥åä¹Ÿæ— æ³•ä¸ä¹‹å‰æ•°æ®èåˆã€‚å¦ä¸€æ–¹é¢ï¼Œæ›´æ–°çš„ç»“æœè¦ä»¥ä¸€ç§åˆé€‚çš„å½¢å¼è¾“å‡ºåˆ°å¤–éƒ¨ç³»ç»Ÿï¼Œæˆ–è€…å°†åŸæ¥ç»“æœè¦†ç›–ï¼Œæˆ–è€…åŒæ—¶ä¿å­˜ä¸”æœ‰æ—¶é—´æˆ³ä»¥è¡¨æ˜æ¥è‡ªæ›´æ–°åçš„è®¡ç®—ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„è®¡ç®—ç»“æœæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆKey-Valueï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªç»“æœè¾“å‡ºåˆ°Redisè¿™æ ·çš„KVæ•°æ®åº“ä¸­ï¼Œä½¿ç”¨æŸäº›Reidså‘½ä»¤ï¼Œå¯¹äºåŒä¸€ä¸ªKeyä¸‹ï¼Œæ—§çš„ç»“æœè¢«æ–°çš„ç»“æœæ‰€è¦†ç›–ã€‚</p>
<p>å¦‚æœä¸æ˜ç¡®è°ƒç”¨<code>allowedLateness</code>ï¼Œé»˜è®¤çš„å…è®¸å»¶è¿Ÿçš„å‚æ•°æ˜¯0ã€‚å¦‚æœå¯¹ä¸€ä¸ªProcessing Timeä¸‹çš„ç¨‹åºä½¿ç”¨<code>allowedLateness</code>ï¼Œå°†å¼•å‘å¼‚å¸¸ã€‚</p>
<p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200602132723.png"/></p>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®çš„çª—å£ä¸º10ç§’ï¼Œ10ç§’ç»“æŸåï¼Œçª—å£è®¡ç®—ä¼šè¢«è§¦å‘ï¼Œç”Ÿæˆç¬¬ä¸€ä¸ªè®¡ç®—ç»“æœã€‚<code>allowedLateness</code>è®¾ç½®çª—å£ç»“æŸåè¿˜è¦ç­‰å¾…é•¿ä¸ºlatenessçš„æ—¶é—´ï¼ŒæŸä¸ªè¿Ÿåˆ°å…ƒç´ çš„Event Timeå¤§äºçª—å£ç»“æŸæ—¶é—´ä½†æ˜¯å°äºç»“æŸæ—¶é—´+latenessï¼Œè¯¥å…ƒç´ ä»ç„¶ä¼šè¢«åŠ å…¥åˆ°è¯¥çª—å£ä¸­ã€‚æ¯æ–°åˆ°ä¸€ä¸ªè¿Ÿåˆ°æ•°æ®ï¼Œè¿Ÿåˆ°æ•°æ®è¢«åŠ å…¥<code>ProcessWindowFunction</code>çš„ç¼“å­˜ä¸­ï¼Œçª—å£çš„Triggerä¼šè§¦å‘ä¸€æ¬¡FIREï¼Œçª—å£å‡½æ•°è¢«é‡æ–°è°ƒç”¨ä¸€æ¬¡ï¼Œè®¡ç®—ç»“æœå¾—åˆ°ä¸€æ¬¡æ›´æ–°ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¼šè¯çª—å£ä¾èµ–Session gapæ¥åˆ‡åˆ†çª—å£ï¼Œä½¿ç”¨äº†<code>allowedLateness</code>å¯èƒ½ä¼šå¯¼è‡´ä¸¤ä¸ªçª—å£åˆå¹¶æˆä¸€ä¸ªçª—å£ã€‚</p>
<h4 id="ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ"><a href="#ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ" class="headerlink" title="ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ"></a>ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ</h4><p><img src="https://gaothink-pics.oss-cn-hangzhou.aliyuncs.com/img/20200602144542.png"/></p>
<p><strong>Wrmarkå’ŒAllowedLatenessåŒºåˆ«</strong></p>
<ul>
<li>watermark é€šè¿‡additionalçš„æ—¶é—´æˆ³æ¥æ§åˆ¶çª—å£æ¿€æ´»çš„æ—¶é—´ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³æ•°æ®ä¹±åºåˆ°è¾¾çš„é—®é¢˜</li>
<li>allowedLateness ç”¨æ¥æ§åˆ¶çª—å£çš„é”€æ¯æ—¶é—´ï¼Œè§£å†³çª—å£è§¦å‘åæ•°æ®è¿Ÿåˆ°åçš„é—®é¢˜</li>
<li>åœ¨flinkä¸­æˆ‘ä»¬ç»å¸¸ä½¿ç”¨watermarkã€allowedLateness ã€ sideOutputLateDataç»“åˆçš„æ–¹å¼å¤„ç†æ•°æ®ä¿è¯çª—å£æ•°æ®ä¸ä¸¢å¤±</li>
</ul>
<hr>
<p>å‚è€ƒï¼š</p>
<p><a href="https://www.jianshu.com/p/c612e95a5028" target="_blank" rel="noopener">å†è°ˆFlinkäº‹ä»¶æ—¶é—´ã€æ°´å°å’Œè¿Ÿåˆ°æ•°æ®å¤„ç†</a></p>

                
                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    
                    <li class="next">
                        <a href="/2020/04/26/Flink-Flink-Context-ç®€å•äº†è§£/" data-toggle="tooltip" data-placement="top" title="Flink Context ç®€å•äº†è§£">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- tip start -->
                
                <div class="comment_notes_blank"></div>
                <div class="visitor_notice">
                    <img 
                        src="/img/notice.png" 
                        alt="notice"
                        title="notice"/>
                    <p class="notice">
                        é™¤éæ³¨æ˜ï¼Œæœ¬åšæ–‡ç« å‡ä¸ºåŸåˆ›ï¼Œè½¬è½½è¯·ä»¥é“¾æ¥å½¢å¼æ ‡æ˜æœ¬æ–‡åœ°å€.
                    </p>
                </div>
                

                
                <div class="comment_notes">
                    <p>
                        
                    </p>
                </div>
                
                <!-- tip end -->

                <!-- Music start-->
                
                <!-- Music end -->

                <!-- Sharing -->
                
                <!-- Sharing -->

                <!-- gitment start -->
                
                <!-- gitment end -->
			
			<!-- valine_comments start -->	
						
			<!-- valine_comments end -->
			
			<!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
                
                <hr>
                <div id="lv-container" data-id="city" data-uid="MTAyMC80OTY0OC8yNjEzOQ==">
                    <script type="text/javascript">
                   (function(d, s) {
                       var j, e = d.getElementsByTagName(s)[0];

                       if (typeof LivereTower === 'function') { return; }

                       j = d.createElement(s);
                       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                       j.async = true;

                       e.parentNode.insertBefore(j, e);
                   })(document, 'script');
                    </script>
                <noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
                </div>
                
                <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->

            </div>
            

			
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Apache-Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Apache Flinkï¼šæ—¶é—´æˆ³ä¸æ°´å°</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Flink-æ—¶é—´è¯­ä¹‰"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">Flink æ—¶é—´è¯­ä¹‰</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Windowåˆ’åˆ†"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">Windowåˆ’åˆ†</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Watermarkæ°´å°"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">Watermarkæ°´å°</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">æå–äº‹ä»¶æ—¶é—´ã€äº§ç”Ÿæ°´å°</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#å‘¨æœŸæ€§æ°´å°-WithPeriodicWatermarks"><span class="toc-nav-number">1.4.1.</span> <span class="toc-nav-text">å‘¨æœŸæ€§æ°´å°(WithPeriodicWatermarks)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#AscendingTimestampExtractor"><span class="toc-nav-number">1.4.1.1.</span> <span class="toc-nav-text">AscendingTimestampExtractor</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#BoundedOutOfOrdernessTimestampExtractor"><span class="toc-nav-number">1.4.1.2.</span> <span class="toc-nav-text">BoundedOutOfOrdernessTimestampExtractor</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#IngestionTimeExtractor"><span class="toc-nav-number">1.4.1.3.</span> <span class="toc-nav-text">IngestionTimeExtractor</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#æ‰“ç‚¹æ°´å°-AssignerWithPunctuatedWatermarks"><span class="toc-nav-number">1.4.2.</span> <span class="toc-nav-text">æ‰“ç‚¹æ°´å°(AssignerWithPunctuatedWatermarks)</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#AllowedLatenessä»‹ç»"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">AllowedLatenessä»‹ç»</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#è¿Ÿåˆ°æ•°æ®å¤„ç†"><span class="toc-nav-number">1.6.</span> <span class="toc-nav-text">è¿Ÿåˆ°æ•°æ®å¤„ç†</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ"><span class="toc-nav-number">1.6.0.1.</span> <span class="toc-nav-text">å°†è¿Ÿåˆ°æ•°æ®ä¸¢å¼ƒ</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®"><span class="toc-nav-number">1.6.0.2.</span> <span class="toc-nav-text">ä¾§è¾“å‡ºè¿Ÿåˆ°æ•°æ®</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#æ›´æ–°è®¡ç®—ç»“æœ"><span class="toc-nav-number">1.6.0.3.</span> <span class="toc-nav-text">æ›´æ–°è®¡ç®—ç»“æœ</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ"><span class="toc-nav-number">1.6.0.4.</span> <span class="toc-nav-text">ä¸WatermarksåŒæ—¶ä½¿ç”¨çš„æƒ…å†µ</span></a></li></ol></li></ol></li></ol></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Flink" title="Flink">Flink</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'â„¬'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>


<style  type="text/css">
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                

                

                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; GY 2021 
                    <br>
                    Powered by 
                    <a href="https://github.com/dusign/hexo-theme-snail" target="_blank" rel="noopener">
                        <i>hexo-theme-snail</i>
                    </a> | 
                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0"
                        width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=dusign&repo=hexo-theme-snail&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>

</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>


<!-- Search -->

<script src="/js/search.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- ç™¾åº¦ç«™é•¿ -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://gaothink.top/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Search -->

    <script type="text/javascript">      
        var search_path = "search.xml";
        if (search_path.length == 0) {
            search_path = "search.xml";
        }
    var path = "/" + search_path;
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>


<!-- busuanzi -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
	
    
        <!-- background effects line -->
        

        
            <script type="text/javascript" src="/js/mouse-click.js" content='[&quot;ğŸŒ±&quot;,&quot;ğŸ€&quot;]' color='[&quot;rgb(121,93,179)&quot; ,&quot;rgb(76,180,231)&quot; ,&quot;rgb(184,90,154)&quot;]'></script>
        

        <!-- background effects end -->
    

    <!--<script size="50" alpha='0.3' zIndex="-999" src="/js/ribbonStatic.js"></script>-->
    
        <script src="/js/ribbonDynamic.js"></script>
    
	
	
        <script type="text/javascript" src="/js/fancybox/jquery.fancybox.min.js"></script>
        <script type="text/javascript" src="/js/wrapImage.js"></script>
    
	
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

</html>
